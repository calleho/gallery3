(function(a){Function.prototype.bind||(Function.prototype.bind=function(a){var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f}),a.Code===void 0&&(a.Code={}),a.Code.Util={registerNamespace:function(){var d,e,f,g,h,i,j,b=arguments,c=null;for(d=0,i=b.length;i>d;d++)for(f=b[d],g=f.split("."),h=g[0],a[h]===void 0&&(a[h]={}),c=a[h],e=1,j=g.length;j>e;++e)c[g[e]]=c[g[e]]||{},c=c[g[e]]},coalesce:function(){var a,b;for(a=0,b=arguments.length;b>a;a++)if(!this.isNothing(arguments[a]))return arguments[a];return null},extend:function(a,b,c){var d;if(this.isNothing(c)&&(c=!0),a&&b&&this.isObject(b))for(d in b)this.objectHasProperty(b,d)&&(c?a[d]=b[d]:a[d]===void 0&&(a[d]=b[d]))},clone:function(a){var b={};return this.extend(b,a),b},isObject:function(a){return a instanceof Object},isFunction:function(a){return"[object Function]"==={}.toString.call(a)},isArray:function(a){return a instanceof Array},isLikeArray:function(a){return"number"==typeof a.length},isNumber:function(a){return"number"==typeof a},isString:function(a){return"string"==typeof a},isNothing:function(a){return a===void 0||null===a?!0:!1},swapArrayElements:function(a,b,c){var d=a[b];a[b]=a[c],a[c]=d},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},toDashedCase:function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},arrayIndexOf:function(a,b,c){var d,e,f,g;for(f=-1,d=0,e=b.length;e>d;d++)if(g=b[d],this.isNothing(c)){if(g===a){f=d;break}}else if(this.objectHasProperty(g,c)&&g[c]===a){f=d;break}return f},objectHasProperty:function(a,b){return a.hasOwnProperty?a.hasOwnProperty(b):a[b]!==void 0}}})(window),function(a,b){b.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=a.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(a.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(a.navigator.platform),this.iPad=/ipad/gi.test(a.navigator.platform),this.iPhone=/iphone/gi.test(a.navigator.platform),this.iPod=/ipod/gi.test(a.navigator.platform);var c=document.createElement("div");this.is3dSupported=!b.isNothing(c.style.WebkitPerspective),this.isCSSTransformSupported=!b.isNothing(c.style.WebkitTransform)||!b.isNothing(c.style.MozTransform)||!b.isNothing(c.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(a){var d,c=document.createElement(this._eventTagNames[a]||"div");return a="on"+a,d=b.objectHasProperty(c,a),d||(c.setAttribute(a,"return;"),d="function"==typeof c[a]),c=null,d},isLandscape:function(){return b.DOM.windowWidth()>b.DOM.windowHeight()}},b.Browser._detect()}(window,window.Code.Util),function(a,b){b.extend(b,{Events:{add:function(a,b,c){this._checkHandlersProperty(a),"mousewheel"===b&&(b=this._normaliseMouseWheelType()),a.__eventHandlers[b]===void 0&&(a.__eventHandlers[b]=[]),a.__eventHandlers[b].push(c),this._isBrowserObject(a)&&a.addEventListener(b,c,!1)},remove:function(a,c,d){if(this._checkHandlersProperty(a),"mousewheel"===c&&(c=this._normaliseMouseWheelType()),a.__eventHandlers[c]instanceof Array){var e,f,g=a.__eventHandlers[c];if(b.isNothing(d)){if(this._isBrowserObject(a))for(e=0,f=g.length;f>e;e++)a.removeEventListener(c,g[e],!1);return a.__eventHandlers[c]=[],void 0}for(e=0,f=g.length;f>e;e++)if(g[e]===d){g.splice(e,1);break}if(this._isBrowserObject(a))return a.removeEventListener(c,d,!1),void 0}},fire:function(c,d){var e,f,g,h,i,k,j=Array.prototype.slice.call(arguments).splice(2);if("mousewheel"===d&&(d=this._normaliseMouseWheelType()),this._isBrowserObject(c)){if("string"!=typeof d)throw"type must be a string for DOM elements";if(k=this._NATIVE_EVENTS[d],g=document.createEvent(k?"HTMLEvents":"UIEvents"),g[k?"initEvent":"initUIEvent"](d,!0,!0,a,1),1>j.length)return c.dispatchEvent(g),void 0}if(this._checkHandlersProperty(c),g="string"==typeof d?{type:d}:d,g.target||(g.target=c),!g.type)throw Error("Event object missing 'type' property.");if(c.__eventHandlers[g.type]instanceof Array)for(h=c.__eventHandlers[g.type],j.unshift(g),e=0,f=h.length;f>e;e++)i=h[e],b.isNothing(i)||i.apply(c,j)},getMousePosition:function(a){var b={x:0,y:0};return a.pageX?b.x=a.pageX:a.clientX&&(b.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)),a.pageY?b.y=a.pageY:a.clientY&&(b.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),b},getTouchEvent:function(a){return a},getWheelDelta:function(a){var c=0;return b.isNothing(a.wheelDelta)?b.isNothing(a.detail)||(c=-a.detail/3):c=a.wheelDelta/120,c},domReady:function(a){document.addEventListener("DOMContentLoaded",a,!1)},_checkHandlersProperty:function(a){b.isNothing(a.__eventHandlers)&&b.extend(a,{__eventHandlers:{}})},_isBrowserObject:function(b){return b===a||b===a.document?!0:this._isElement(b)||this._isNode(b)},_isElement:function(b){return"object"==typeof a.HTMLElement?b instanceof a.HTMLElement:"object"==typeof b&&1===b.nodeType&&"string"==typeof b.nodeName},_isNode:function(b){return"object"==typeof a.Node?b instanceof a.Node:"object"==typeof b&&"number"==typeof b.nodeType&&"string"==typeof b.nodeName},_normaliseMouseWheelType:function(){return b.Browser.isEventSupported("mousewheel")?"mousewheel":"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})}(window,window.Code.Util),function(a,b){b.extend(b,{DOM:{setData:function(a,c,d){if(b.isLikeArray(a)){var e,f;for(e=0,f=a.length;f>e;e++)b.DOM._setData(a[e],c,d)}else b.DOM._setData(a,c,d)},_setData:function(a,c,d){b.DOM.setAttribute(a,"data-"+c,d)},getData:function(a,c,d){return b.DOM.getAttribute(a,"data-"+c,d)},removeData:function(a,c){if(b.isLikeArray(a)){var d,e;for(d=0,e=a.length;e>d;d++)b.DOM._removeData(a[d],c)}else b.DOM._removeData(a,c)},_removeData:function(a,c){b.DOM.removeAttribute(a,"data-"+c)},isChildOf:function(a,b){if(b===a)return!1;for(;a&&a!==b;)a=a.parentNode;return a===b},find:function(c,d){b.isNothing(d)&&(d=a.document);var g,h,e=d.querySelectorAll(c),f=[];for(g=0,h=e.length;h>g;g++)f.push(e[g]);return f},createElement:function(a,c,d){var e,f=document.createElement(a);for(e in c)b.objectHasProperty(c,e)&&f.setAttribute(e,c[e]);return f.innerHTML=d||"",f},appendChild:function(a,b){b.appendChild(a)},insertBefore:function(a,b,c){c.insertBefore(a,b)},appendText:function(a,c){b.DOM.appendChild(document.createTextNode(a),c)},appendToBody:function(a){this.appendChild(a,document.body)},removeChild:function(a,b){b.removeChild(a)},removeChildren:function(a){if(a.hasChildNodes())for(;a.childNodes.length>=1;)a.removeChild(a.childNodes[a.childNodes.length-1])},hasAttribute:function(a,c){return!b.isNothing(a.getAttribute(c))},getAttribute:function(a,c,d){var e=a.getAttribute(c);return b.isNothing(e)&&!b.isNothing(d)&&(e=d),e},setAttribute:function(a,c,d){if(b.isLikeArray(a)){var e,f;for(e=0,f=a.length;f>e;e++)b.DOM._setAttribute(a[e],c,d)}else b.DOM._setAttribute(a,c,d)},_setAttribute:function(a,b,c){a.setAttribute(b,c)},removeAttribute:function(a,c){if(b.isLikeArray(a)){var d,e;for(d=0,e=a.length;e>d;d++)b.DOM._removeAttribute(a[d],c)}else b.DOM._removeAttribute(a,c)},_removeAttribute:function(a,b){this.hasAttribute(a,b)&&a.removeAttribute(b)},addClass:function(a,c){if(b.isLikeArray(a)){var d,e;for(d=0,e=a.length;e>d;d++)b.DOM._addClass(a[d],c)}else b.DOM._addClass(a,c)},_addClass:function(a,c){var d=b.DOM.getAttribute(a,"class",""),e=RegExp("(?:^|\\s+)"+c+"(?:\\s+|$)");e.test(d)||(""!==d&&(d+=" "),d+=c,b.DOM.setAttribute(a,"class",d))},removeClass:function(a,c){if(b.isLikeArray(a)){var d,e;for(d=0,e=a.length;e>d;d++)b.DOM._removeClass(a[d],c)}else b.DOM._removeClass(a,c)},_removeClass:function(a,c){var g,h,d=b.DOM.getAttribute(a,"class",""),e=b.trim(d).split(" "),f="";for(g=0,h=e.length;h>g;g++)e[g]!==c&&(""!==f&&(f+=" "),f+=e[g]);""===f?b.DOM.removeAttribute(a,"class"):b.DOM.setAttribute(a,"class",f)},hasClass:function(a,c){var d=RegExp("(?:^|\\s+)"+c+"(?:\\s+|$)");return d.test(b.DOM.getAttribute(a,"class",""))},setStyle:function(a,c,d){if(b.isLikeArray(a)){var e,f;for(e=0,f=a.length;f>e;e++)b.DOM._setStyle(a[e],c,d)}else b.DOM._setStyle(a,c,d)},_setStyle:function(a,c,d){var e;if(b.isObject(c))for(e in c)b.objectHasProperty(c,e)&&("width"===e?b.DOM.width(a,c[e]):"height"===e?b.DOM.height(a,c[e]):a.style[e]=c[e]);else a.style[c]=d},getStyle:function(b,c){var d=a.getComputedStyle(b,"").getPropertyValue(c);return""===d&&(d=b.style[c]),d},hide:function(a){if(b.isLikeArray(a)){var c,d;for(c=0,d=a.length;d>c;c++)b.DOM._hide(a[c])}else b.DOM._hide(a)},_hide:function(a){b.DOM.setData(a,"ccl-disp",b.DOM.getStyle(a,"display")),b.DOM.setStyle(a,"display","none")},show:function(a){if(b.isLikeArray(a)){var c,d;for(c=0,d=a.length;d>c;c++)b.DOM._show(a[c])}else b.DOM._show(a)},_show:function(a){if("none"===b.DOM.getStyle(a,"display")){var c=b.DOM.getData(a,"ccl-disp","block");("none"===c||""===c)&&(c="block"),b.DOM.setStyle(a,"display",c)}},width:function(a,c){return b.isNothing(c)||(b.isNumber(c)&&(c+="px"),a.style.width=c),this._getDimension(a,"width")},outerWidth:function(a){var c=b.DOM.width(a);return c+=parseInt(b.DOM.getStyle(a,"padding-left"),10)+parseInt(b.DOM.getStyle(a,"padding-right"),10),c+=parseInt(b.DOM.getStyle(a,"margin-left"),10)+parseInt(b.DOM.getStyle(a,"margin-right"),10),c+=parseInt(b.DOM.getStyle(a,"border-left-width"),10)+parseInt(b.DOM.getStyle(a,"border-right-width"),10)},height:function(a,c){return b.isNothing(c)||(b.isNumber(c)&&(c+="px"),a.style.height=c),this._getDimension(a,"height")},_getDimension:function(b,c){var e,d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c));return isNaN(d)&&(e={display:b.style.display,left:b.style.left},b.style.display="block",b.style.left="-1000000px",d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c)),b.style.display=e.display,b.style.left=e.left),d},outerHeight:function(a){var c=b.DOM.height(a);return c+=parseInt(b.DOM.getStyle(a,"padding-top"),10)+parseInt(b.DOM.getStyle(a,"padding-bottom"),10),c+=parseInt(b.DOM.getStyle(a,"margin-top"),10)+parseInt(b.DOM.getStyle(a,"margin-bottom"),10),c+=parseInt(b.DOM.getStyle(a,"border-top-width"),10)+parseInt(b.DOM.getStyle(a,"border-bottom-width"),10)},documentWidth:function(){return b.DOM.width(document.documentElement)},documentHeight:function(){return b.DOM.height(document.documentElement)},documentOuterWidth:function(){return b.DOM.width(document.documentElement)},documentOuterHeight:function(){return b.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return b.DOM.width(document.body)},bodyHeight:function(){return b.DOM.height(document.body)},bodyOuterWidth:function(){return b.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return b.DOM.outerHeight(document.body)},windowWidth:function(){return a.innerWidth},windowHeight:function(){return a.innerHeight},windowScrollLeft:function(){return a.pageXOffset},windowScrollTop:function(){return a.pageYOffset}}})}(window,window.Code.Util),function(a,b){b.extend(b,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:void 0!==a.document.documentElement.style.webkitTransition?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:void 0!==a.document.documentElement.style.webkitTransition?"webkitTransition":void 0!==a.document.documentElement.style.MozTransition?"MozTransition":"transition",_transformLabel:void 0!==a.document.documentElement.style.webkitTransform?"webkitTransform":void 0!==a.document.documentElement.style.MozTransition?"MozTransform":"transform",_getTransitionEndHandler:function(){return b.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(c){if(b.Browser.isCSSTransformSupported){var f=(c.style[this._transitionPrefix+"Property"],{});b.Events.remove(c,this._transitionEndLabel,this._getTransitionEndHandler()),b.isNothing(c.callbackLabel)&&delete c.callbackLabel,f[this._transitionPrefix+"Property"]="",f[this._transitionPrefix+"Duration"]="",f[this._transitionPrefix+"TimingFunction"]="",f[this._transitionPrefix+"Delay"]="",f[this._transformLabel]="",b.DOM.setStyle(c,f)}else b.isNothing(a.jQuery)||a.jQuery(c).stop(!0,!0)},fadeIn:function(c,d,e,f,g){if(g=b.coalesce(g,1),0>=g&&(g=1),0>=d&&(b.DOM.setStyle(c,"opacity",g),!b.isNothing(e)))return e(c),void 0;var h=b.DOM.getStyle(c,"opacity");h>=1&&b.DOM.setStyle(c,"opacity",0),b.Browser.isCSSTransformSupported?this._applyTransition(c,"opacity",g,d,e,f):b.isNothing(a.jQuery)||a.jQuery(c).fadeTo(d,g,e)},fadeTo:function(a,b,c,d,e){this.fadeIn(a,c,d,e,b)},fadeOut:function(c,d,e,f){return 0>=d&&(b.DOM.setStyle(c,"opacity",0),!b.isNothing(e))?(e(c),void 0):(b.Browser.isCSSTransformSupported?this._applyTransition(c,"opacity",0,d,e,f):a.jQuery(c).fadeTo(d,0,e),void 0)},slideBy:function(c,d,e,f,g,h){var i={};d=b.coalesce(d,0),e=b.coalesce(e,0),h=b.coalesce(h,"ease-out"),i[this._transitionPrefix+"Property"]="all",i[this._transitionPrefix+"Delay"]="0",0===f?(i[this._transitionPrefix+"Duration"]="",i[this._transitionPrefix+"TimingFunction"]=""):(i[this._transitionPrefix+"Duration"]=f+"ms",i[this._transitionPrefix+"TimingFunction"]=b.coalesce(h,"ease-out"),b.Events.add(c,this._transitionEndLabel,this._getTransitionEndHandler())),i[this._transformLabel]=b.Browser.is3dSupported?"translate3d("+d+"px, "+e+"px, 0px)":"translate("+d+"px, "+e+"px)",b.isNothing(g)||(c.cclallcallback=g),b.DOM.setStyle(c,i),0===f&&a.setTimeout(function(){this._leaveTransforms(c)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(a){var c={};c[this._transformLabel]=c[this._transformLabel]=b.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",b.DOM.setStyle(a,c)},_applyTransition:function(c,d,e,f,g,h){var i={};h=b.coalesce(h,"ease-in"),i[this._transitionPrefix+"Property"]=d,i[this._transitionPrefix+"Duration"]=f+"ms",i[this._transitionPrefix+"TimingFunction"]=h,i[this._transitionPrefix+"Delay"]="0",b.Events.add(c,this._transitionEndLabel,this._getTransitionEndHandler()),b.DOM.setStyle(c,i),b.isNothing(g)||(c["ccl"+d+"callback"]=g),a.setTimeout(function(){b.DOM.setStyle(c,d,e)},this._applyTransitionDelay)},_onTransitionEnd:function(a){b.Events.remove(a.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(a.currentTarget)},_leaveTransforms:function(c){var f,h,i,l,m,d=c.style[this._transitionPrefix+"Property"],e=""!==d?"ccl"+d+"callback":"cclallcallback",g=b.coalesce(c.style.webkitTransform,c.style.MozTransform,c.style.transform),j=a.parseInt(b.DOM.getStyle(c,"left"),0),k=a.parseInt(b.DOM.getStyle(c,"top"),0),n={};""!==g&&(h=b.Browser.is3dSupported?g.match(/translate3d\((.*?)\)/):g.match(/translate\((.*?)\)/),b.isNothing(h)||(i=h[1].split(", "),l=a.parseInt(i[0],0),m=a.parseInt(i[1],0))),n[this._transitionPrefix+"Property"]="",n[this._transitionPrefix+"Duration"]="",n[this._transitionPrefix+"TimingFunction"]="",n[this._transitionPrefix+"Delay"]="",b.DOM.setStyle(c,n),a.setTimeout(function(){b.isNothing(i)||(n={},n[this._transformLabel]="",n.left=j+l+"px",n.top=k+m+"px",b.DOM.setStyle(c,n)),b.isNothing(c[e])||(f=c[e],delete c[e],f(c))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},c.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.TouchElementClass=b({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var a;this.removeEventHandlers();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){this.el=a,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},c.extend(this.captureSettings,b),this.swipeThreshold=50,this.swipeTimeThreshold=250,this.doubleTapSpeed=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){c.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),c.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.add(this.el,"touchmove",this.touchMoveHandler),c.Events.add(this.el,"touchend",this.touchEndHandler),c.Events.add(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.add(this.el,"gesturestart",this.gestureStartHandler),c.Events.add(this.el,"gesturechange",this.gestureChangeHandler),c.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){c.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),c.Events.remove(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.remove(this.el,"gesturestart",this.gestureStartHandler),c.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),c.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(a){return{x:a[0].pageX,y:a[0].pageY}},fireTouchEvent:function(b){var i,j,e=0,f=0,g=0;if(e=this.touchEndPoint.x-this.touchStartPoint.x,f=this.touchEndPoint.y-this.touchStartPoint.y,g=Math.sqrt(e*e+f*f),this.captureSettings.swipe&&(i=new Date,j=i-this.touchStartTime,this.swipeTimeThreshold>=j)){if(a.Math.abs(e)>=this.swipeThreshold)return c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>e?c.TouchElement.ActionTypes.swipeLeft:c.TouchElement.ActionTypes.swipeRight,targetEl:b.target,currentTargetEl:b.currentTarget}),void 0;if(a.Math.abs(f)>=this.swipeThreshold)return c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:0>f?c.TouchElement.ActionTypes.swipeUp:c.TouchElement.ActionTypes.swipeDown,targetEl:b.target,currentTargetEl:b.currentTarget}),void 0}return g>1?(c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:b.target,currentTargetEl:b.currentTarget}),void 0):this.captureSettings.doubleTap?c.isNothing(this.doubleTapTimeout)?(this.doubleTapTimeout=a.setTimeout(function(){this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget})}.bind(this),this.doubleTapSpeed),void 0):(a.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.doubleTap,targetEl:b.target,currentTargetEl:b.currentTarget}),void 0):(c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget}),void 0)},onTouchStart:function(a){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault(),c.Events.remove(this.el,"mousedown",this.mouseDownHandler);var b=c.Events.getTouchEvent(a),d=b.touches;return d.length>1&&this.captureSettings.gesture?(this.isGesture=!0,void 0):(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(d),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),void 0)},onTouchMove:function(a){if(this.captureSettings.preventDefaultTouchEvents&&a.preventDefault(),!this.isGesture||!this.captureSettings.gesture){var b=c.Events.getTouchEvent(a),d=b.touches;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(d),targetEl:a.target,currentTargetEl:a.currentTarget})}},onTouchEnd:function(a){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault();var b=c.Events.getTouchEvent(a),d=c.isNothing(b.changedTouches)?b.touches:b.changedTouches;this.touchEndPoint=this.getTouchPoint(d),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)}},onMouseDown:function(a){a.preventDefault(),c.Events.remove(this.el,"touchstart",this.mouseDownHandler),c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&c.Events.add(this.el,"mousemove",this.mouseMoveHandler),c.Events.add(this.el,"mouseup",this.mouseUpHandler),c.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseMove:function(a){a.preventDefault(),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:c.Events.getMousePosition(a),targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseUp:function(a){a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)},onMouseOut:function(a){var b=a.relatedTarget;this.el===b||c.DOM.isChildOf(b,this.el)||(a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a))},onGestureStart:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureStart,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureChange:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureChange,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureEnd:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureEnd,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image");var d=a.Code.PhotoSwipe;d.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image");var d=a.Code.PhotoSwipe;d.Image.ImageClass=b({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var a;this.shrinkImage();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,d,e,f){this.refObj=b,this.originalSrc=d,this.src=d,this.caption=e,this.metaData=f,"video"==f.type?(this.imageEl=document.createElement("video"),this.imageEl.controls=!0,this.imageEl.width=c.DOM.windowWidth(),this.imageEl.height=.8*c.DOM.windowHeight()):this.imageEl=new a.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){return this.imageEl.originalSrc=c.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc===this.src?(this.imageEl.isError?c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this}):c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this}),void 0):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src,"video"==this.metaData.type&&(this.imageEl.poster=this.metaData.thumburl+"_"+Math.floor(11*Math.random()),this.imageEl.naturalWidth=300,this.imageEl.naturalHeight=150,this.imageEl.src=this.imageEl.src+"_"+Math.floor(11*Math.random()),this.imageEl.originalSrc=this.imageEl.src),void 0)},shrinkImage:function(){c.isNothing(this.imageEl)||this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",c.isNothing(this.imageEl.parentNode)||c.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null,this.imageEl.naturalWidth=c.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=c.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache");var d=a.Code.PhotoSwipe;d.Cache.Mode={normal:"normal",aggressive:"aggressive"},d.Cache.Functions={getImageSource:function(a){return a.href},getImageCaption:function(a){if("IMG"===a.nodeName)return c.DOM.getAttribute(a,"alt");var b,d,e;for(b=0,d=a.childNodes.length;d>b;b++)if(e=a.childNodes[b],"IMG"===a.childNodes[b].nodeName)return c.DOM.getAttribute(e,"alt")},getImageMetaData:function(){return{}}}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache");var d=a.Code.PhotoSwipe;d.Cache.CacheClass=b({images:null,settings:null,dispose:function(){var a,b,d;if(!c.isNothing(this.images)){for(b=0,d=this.images.length;d>b;b++)this.images[b].dispose();this.images.length=0}for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){var c,e,g,h,i,j;for(this.settings=b,this.images=[],c=0,e=a.length;e>c;c++)g=a[c],h=this.settings.getImageSource(g),i=this.settings.getImageCaption(g),j=this.settings.getImageMetaData(g),this.images.push(new d.Image.ImageClass(g,h,i,j))},getImages:function(a){var b,e,g,f=[];for(b=0,e=a.length;e>b;b++)g=this.images[a[b]],this.settings.cacheMode===d.Cache.Mode.aggressive&&(g.cacheDoNotShrink=!0),f.push(g);if(this.settings.cacheMode===d.Cache.Mode.aggressive)for(b=0,e=this.images.length;e>b;b++)g=this.images[b],c.objectHasProperty(g,"cacheDoNotShrink")?delete g.cacheDoNotShrink:g.shrinkImage();return f}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var d=a.Code.PhotoSwipe;d.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var d=a.Code.PhotoSwipe;d.DocumentOverlay.DocumentOverlayClass=b({el:null,settings:null,initialBodyHeight:null,dispose:function(){var a;c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.DocumentOverlay.CssClasses.documentOverlay},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),c.Animation.resetTranslate(this.el),this.initialBodyHeight=c.DOM.bodyOuterHeight()},resetPosition:function(){var b,d,e;this.settings.target===a?(b=c.DOM.windowWidth(),d=2*c.DOM.bodyOuterHeight(),e=this.settings.jQueryMobile?c.DOM.windowScrollTop()+"px":"0px",1>d&&(d=this.initialBodyHeight),c.DOM.windowHeight()>d&&(d=c.DOM.windowHeight())):(b=c.DOM.width(this.settings.target),d=c.DOM.height(this.settings.target),e="0px"),c.DOM.setStyle(this.el,{width:b,height:d,top:e})},fadeIn:function(a,b){this.resetPosition(),c.DOM.setStyle(this.el,"opacity",0),c.DOM.show(this.el),c.Animation.fadeIn(this.el,a,b)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel");var d=a.Code.PhotoSwipe;d.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},d.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},d.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}
}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel");var d=a.Code.PhotoSwipe;d.Carousel.CarouselClass=b({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var a,b,e;for(b=0,e=this.cache.images.length;e>b;b++)c.Events.remove(this.cache.images[b],d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(this.cache.images[b],d.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow(),c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e){var f,g,h;for(this.cache=b,this.settings=e,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSliding=!1,this.isSlideshowActive=!1,3>this.cache.images.length&&(this.settings.loop=!1),this.el=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.carousel},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.contentEl=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.content},""),c.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),c.DOM.appendChild(this.contentEl,this.el),g=3>b.images.length?b.images.length:3,f=0;g>f;f++)h=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.item+" "+d.Carousel.CssClasses.item+"-"+f},""),c.DOM.setAttribute(h,"style","float: left;"),c.DOM.setStyle(h,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&c.DOM.setStyle(h,{marginRight:this.settings.margin+"px"}),c.DOM.appendChild(h,this.contentEl);this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var b,e,f,g,h,i,j,k,l,m;for(this.settings.target===a?(b=c.DOM.windowWidth(),e=c.DOM.windowHeight(),f=c.DOM.windowScrollTop()+"px"):(b=c.DOM.width(this.settings.target),e=c.DOM.height(this.settings.target),f="0px"),g=this.settings.margin>0?b+this.settings.margin:b,h=c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl),i=g*h.length,c.DOM.setStyle(this.el,{top:f,width:b,height:e}),c.DOM.setStyle(this.contentEl,{width:i,height:e}),j=0,k=h.length;k>j;j++)l=h[j],c.DOM.setStyle(l,{width:b,height:e}),m=c.DOM.find("img",l)[0],c.isNothing(m)&&(m=c.DOM.find("video",l)[0]),c.isNothing(m)||this.resetImagePosition(m);this.setContentLeftPosition()},resetImagePosition:function(a){if(!c.isNothing(a)){var d,e,f,g,h,i=(c.DOM.getAttribute(a,"src"),c.DOM.width(this.el)),j=c.DOM.height(this.el);"fitNoUpscale"===this.settings.imageScaleMethod?(e=a.naturalWidth,f=a.naturalHeight,e>i&&(d=i/e,e=Math.round(e*d),f=Math.round(f*d)),f>j&&(d=j/f,f=Math.round(f*d),e=Math.round(e*d))):(d=a.isLandscape?i/a.naturalWidth:j/a.naturalHeight,e=Math.round(a.naturalWidth*d),f=Math.round(a.naturalHeight*d),"zoom"===this.settings.imageScaleMethod?(d=1,j>f?d=j/f:i>e&&(d=i/e),1!==d&&(e=Math.round(e*d),f=Math.round(f*d))):"fit"===this.settings.imageScaleMethod&&(d=1,e>i?d=i/e:f>j&&(d=j/f),1!==d&&(e=Math.round(e*d),f=Math.round(f*d)))),g=Math.round((j-f)/2)+"px",h=Math.round((i-e)/2)+"px",c.DOM.setStyle(a,{position:"absolute",width:e,height:f,top:g,left:h,display:"block"})}},setContentLeftPosition:function(){var b,d,e;b=this.settings.target===a?c.DOM.windowWidth():c.DOM.width(this.settings.target),d=this.getItemEls(),e=0,this.settings.loop?e=-1*(b+this.settings.margin):this.currentCacheIndex===this.cache.images.length-1?e=-1*(d.length-1)*(b+this.settings.margin):this.currentCacheIndex>0&&(e=-1*(b+this.settings.margin)),c.DOM.setStyle(this.contentEl,{left:e+"px"})},show:function(a){this.currentCacheIndex=a,this.resetPosition(),this.setImages(!1),c.DOM.show(this.el),c.Animation.resetTranslate(this.contentEl);var e,f,b=this.getItemEls();for(e=0,f=b.length;f>e;e++)c.Animation.resetTranslate(b[e]);c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:d.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(a){var b,c=this.getItemEls(),d=this.currentCacheIndex+1,e=this.currentCacheIndex-1;this.settings.loop?(d>this.cache.images.length-1&&(d=0),0>e&&(e=this.cache.images.length-1),b=this.cache.getImages([e,this.currentCacheIndex,d]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[0],c[0])):1===c.length?a||(b=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(b[0],c[0])):2===c.length?0===this.currentCacheIndex?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[0],c[0])):0===this.currentCacheIndex?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2])):this.currentCacheIndex===this.cache.images.length-1?(b=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[0],c[0])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[0],c[0]))},addCacheImageToItemEl:function(a,b){c.DOM.removeClass(b,d.Carousel.CssClasses.itemError),"video"!=a.metaData.type&&c.DOM.addClass(b,d.Carousel.CssClasses.itemLoading),c.DOM.removeChildren(b),"video"!=a.metaData.type&&c.DOM.setStyle(a.imageEl,{display:"none"}),c.DOM.appendChild(a.imageEl,b),c.Animation.resetTranslate(a.imageEl),c.Events.add(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.add(a,d.Image.EventTypes.onError,this.imageErrorHandler),a.load()},slideCarousel:function(b,e,f){if(!this.isSliding){var g,h,i;if(g=this.settings.target===a?c.DOM.windowWidth()+this.settings.margin:c.DOM.width(this.settings.target)+this.settings.margin,f=c.coalesce(f,this.settings.slideSpeed),!(1>a.Math.abs(h))){switch(e){case c.TouchElement.ActionTypes.swipeLeft:i=-1*g;break;case c.TouchElement.ActionTypes.swipeRight:i=g;break;default:h=b.x-this.touchStartPoint.x,i=a.Math.abs(h)>g/2?h>0?g:-1*g:0}this.lastSlideByAction=0>i?d.Carousel.SlideByAction.next:i>0?d.Carousel.SlideByAction.previous:d.Carousel.SlideByAction.current,this.settings.loop||(this.lastSlideByAction===d.Carousel.SlideByAction.previous&&0===this.currentCacheIndex||this.lastSlideByAction===d.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(i=0,this.lastSlideByAction=d.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(i,f)}}},moveCarousel:function(a){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(a.x-this.touchStartPoint.x)},getItemEls:function(){return c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=a.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){c.isNothing(this.slideshowTimeout)||(a.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!c.isNothing(this.isSliding)){var b=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===d.Carousel.SlideByAction.next?this.currentCacheIndex=this.currentCacheIndex+1:this.lastSlideByAction===d.Carousel.SlideByAction.previous&&(this.currentCacheIndex=this.currentCacheIndex-1),this.settings.loop?(this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(b[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(b[b.length-1],b[0],this.contentEl),0>this.currentCacheIndex?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0)):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(b[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(b[b.length-1],b[0],this.contentEl):1===this.currentCacheIndex?this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(b[b.length-1],b[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===d.Carousel.SlideByAction.next&&c.DOM.appendChild(b[0],this.contentEl)),this.lastSlideByAction!==d.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==d.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(b,d){switch(this.stopSlideshow(),b){case c.TouchElement.ActionTypes.touchStart:this.touchStartPoint=d,this.touchStartPosition={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)};break;case c.TouchElement.ActionTypes.touchMove:this.moveCarousel(d);break;case c.TouchElement.ActionTypes.touchMoveEnd:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.slideCarousel(d,b);break;case c.TouchElement.ActionTypes.tap:break;case c.TouchElement.ActionTypes.doubleTap:}},onImageLoad:function(a){var b=a.target;c.isNothing(b.imageEl.parentNode)||(c.DOM.removeClass(b.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),this.resetImagePosition(b.imageEl)),c.Events.remove(b,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(b,d.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(a){var b=a.target;c.isNothing(b.imageEl.parentNode)||(c.DOM.removeClass(b.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),c.DOM.addClass(b.imageEl.parentNode,d.Carousel.CssClasses.itemError)),c.Events.remove(b,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(b,d.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel");var e=a.Code.PhotoSwipe;e.Carousel.CarouselClass=e.Carousel.CarouselClass.extend({getStartingPos:function(){var b=this.touchStartPosition;return c.isNothing(b)&&(b={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)}),b},doMoveCarousel:function(b){var d;c.Browser.isCSSTransformSupported?(d={},d[c.Animation._transitionPrefix+"Property"]="all",d[c.Animation._transitionPrefix+"Duration"]="",d[c.Animation._transitionPrefix+"TimingFunction"]="",d[c.Animation._transitionPrefix+"Delay"]="0",d[c.Animation._transformLabel]=c.Browser.is3dSupported?"translate3d("+b+"px, 0px, 0px)":"translate("+b+"px, 0px)",c.DOM.setStyle(this.contentEl,d)):c.isNothing(a.jQuery)||a.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+b+"px")},doSlideCarousel:function(b,d){var e,f;if(0>=d)return this.slideByEndHandler(),void 0;if(c.Browser.isCSSTransformSupported){if(f=c.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),0===f.indexOf("translate3d("+b))return this.slideByEndHandler(),void 0;if(0===f.indexOf("translate("+b))return this.slideByEndHandler(),void 0;c.Animation.slideBy(this.contentEl,b,0,d,this.slideByEndHandler,this.settings.slideTimingFunction)}else c.isNothing(a.jQuery)||(e={left:this.getStartingPos().x+b+"px"},"ease-out"===this.settings.animationTimingFunction&&(this.settings.animationTimingFunction="easeOutQuad"),c.isNothing(a.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),a.jQuery(this.contentEl).animate(e,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},d.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},d.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},d.Toolbar.getToolbar=function(){return'<div class="'+d.Toolbar.CssClasses.close+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.play+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.previous+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.next+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.ToolbarClass=b({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var a;this.clearTimeout(),this.removeEventHandlers(),c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),c.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),c.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e){var f;this.settings=e,this.cache=b,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),f=d.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(f=f+" "+d.Toolbar.CssClasses.toolbarTop),this.toolbarEl=c.DOM.createElement("div",{"class":f},this.settings.getToolbar()),c.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.toolbarEl):c.DOM.appendChild(this.toolbarEl,this.settings.target),c.DOM.hide(this.toolbarEl),this.closeEl=c.DOM.find("."+d.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!c.isNothing(this.closeEl)&&c.DOM.hide(this.closeEl),this.playEl=c.DOM.find("."+d.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!c.isNothing(this.playEl)&&c.DOM.hide(this.playEl),this.nextEl=c.DOM.find("."+d.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=c.DOM.find("."+d.Toolbar.CssClasses.previous,this.toolbarEl)[0],f=d.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(f=f+" "+d.Toolbar.CssClasses.captionBottom),this.captionEl=c.DOM.createElement("div",{"class":f},""),c.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.captionEl):c.DOM.appendChild(this.captionEl,this.settings.target),c.DOM.hide(this.captionEl),this.captionContentEl=c.DOM.createElement("div",{"class":d.Toolbar.CssClasses.captionContent},""),c.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var b,d,e;this.settings.target===a?(this.settings.captionAndToolbarFlipPosition?(d=c.DOM.windowScrollTop(),e=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.captionEl)):(d=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.toolbarEl),e=c.DOM.windowScrollTop()),b=c.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(d="0",e=c.DOM.height(this.settings.target)-c.DOM.height(this.captionEl)):(d=c.DOM.height(this.settings.target)-c.DOM.height(this.toolbarEl),e=0),b=c.DOM.width(this.settings.target)),c.DOM.setStyle(this.toolbarEl,{top:d+"px",width:b}),c.DOM.setStyle(this.captionEl,{top:e+"px",width:b})},toggleVisibility:function(a){this.isVisible?this.fadeOut():this.show(a)},show:function(a){c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(a),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(a),this.showCaption(),this.isVisible=!0,this.setTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=a.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){c.isNothing(this.timeout)||(a.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeHide,target:this}),c.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),c.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(a){this.clearTimeout();var b;a.target===this.nextEl||c.DOM.isChildOf(a.target,this.nextEl)?b=d.Toolbar.ToolbarAction.next:a.target===this.previousEl||c.DOM.isChildOf(a.target,this.previousEl)?b=d.Toolbar.ToolbarAction.previous:a.target===this.closeEl||c.DOM.isChildOf(a.target,this.closeEl)?b=d.Toolbar.ToolbarAction.close:(a.target===this.playEl||c.DOM.isChildOf(a.target,this.playEl))&&(b=d.Toolbar.ToolbarAction.play),this.setTimeout(),c.isNothing(b)&&(b=d.Toolbar.ToolbarAction.none),c.Events.fire(this,{type:d.Toolbar.EventTypes.onTap,target:this,action:b,tapTarget:a.target})},setCaption:function(a){c.DOM.removeChildren(this.captionContentEl),this.currentCaption=c.coalesce(this.cache.images[a].caption,"\u00a0"),c.isObject(this.currentCaption)?c.DOM.appendChild(this.currentCaption,this.captionContentEl):(""===this.currentCaption&&(this.currentCaption="\u00a0"),c.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption="\u00a0"===this.currentCaption?"":this.currentCaption,this.resetPosition()},showToolbar:function(){c.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.toolbarEl)},showCaption:function(){return(""===this.currentCaption||1>this.captionContentEl.childNodes.length)&&!this.settings.captionAndToolbarShowEmptyCaptions?(c.DOM.hide(this.captionEl),void 0):(c.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.captionEl),void 0)},setToolbarStatus:function(a){this.settings.loop||(c.DOM.removeClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled),c.DOM.removeClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled),a>0&&this.cache.images.length-1>a||(0===a&&(c.isNothing(this.previousEl)||c.DOM.addClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled)),a===this.cache.images.length-1&&(c.isNothing(this.nextEl)||c.DOM.addClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){c.DOM.hide(this.toolbarEl),c.DOM.hide(this.captionEl),c.Events.fire(this,{type:d.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(a){a.preventDefault(),c.Events.remove(this.toolbarEl,"click",this.clickHandler),this.handleTap(a)},onTouchMove:function(a){a.preventDefault()},onClick:function(a){a.preventDefault(),this.handleTap(a)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer");var d=a.Code.PhotoSwipe;d.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer");var d=a.Code.PhotoSwipe;d.UILayer.UILayerClass=c.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var a;this.removeEventHandlers(),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.UILayer.CssClasses.uiLayer},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:c.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===a?c.DOM.setStyle(this.el,{top:c.DOM.windowScrollTop()+"px",width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}):c.DOM.setStyle(this.el,{top:"0px",width:c.DOM.width(this.settings.target),height:c.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),c.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var d=a.Code.PhotoSwipe;d.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},d.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var d=a.Code.PhotoSwipe;d.ZoomPanRotate.ZoomPanRotateClass=b({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var a;c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e,f){var g,h,i,j;this.settings=b,this.settings.target===a?(g=document.body,h=c.DOM.windowWidth(),i=c.DOM.windowHeight(),j=c.DOM.windowScrollTop()+"px"):(g=this.settings.target,h=c.DOM.width(g),i=c.DOM.height(g),j="0px"),this.imageEl=e.imageEl.cloneNode(!1),c.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=c.DOM.createElement("div",{"class":d.ZoomPanRotate.CssClasses.zoomPanRotate},""),c.DOM.setStyle(this.el,{left:0,top:j,position:"absolute",width:h,height:i,zIndex:this.settings.zIndex,display:"block"}),c.DOM.insertBefore(this.el,f.el,g),c.Browser.iOS?(this.containerEl=c.DOM.createElement("div","",""),c.DOM.setStyle(this.containerEl,{left:0,top:0,width:h,height:i,position:"absolute",zIndex:1}),c.DOM.appendChild(this.imageEl,this.containerEl),c.DOM.appendChild(this.containerEl,this.el),c.Animation.resetTranslate(this.containerEl),c.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(c.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var d,b=c.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);c.isNothing(b)||(d=b.match(/translate\((.*?)\)/),c.isNothing(d)||(d=d[1].split(", "),this.transformSettings.startingTranslateX=a.parseInt(d[0],10),this.transformSettings.startingTranslateY=a.parseInt(d[1],10)))},getScale:function(a){var b=this.transformSettings.startingScale*a;return 0!==this.settings.minUserZoom&&this.settings.minUserZoom>b?b=this.settings.minUserZoom:0!==this.settings.maxUserZoom&&b>this.settings.maxUserZoom&&(b=this.settings.maxUserZoom),b},setStartingScaleAndRotation:function(a,b){this.transformSettings.startingScale=this.getScale(a),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+b)%360},zoomRotate:function(a,b){this.transformSettings.scale=this.getScale(a),this.transformSettings.rotation=this.transformSettings.startingRotation+b,this.applyTransform()},panStart:function(a){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:a.x,y:a.y}},pan:function(a){var b=a.x-this.panStartingPoint.x,c=a.y-this.panStartingPoint.y,d=b/this.transformSettings.scale,e=c/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+d,this.transformSettings.translateY=this.transformSettings.startingTranslateY+e,this.applyTransform()},zoomAndPanToPoint:function(b,d){if(this.settings.target===a){this.panStart({x:c.DOM.windowWidth()/2,y:c.DOM.windowHeight()/2});var e=d.x-this.panStartingPoint.x,f=d.y-this.panStartingPoint.y,g=e/this.transformSettings.scale,h=f/this.transformSettings.scale;this.transformSettings.translateX=-1*(this.transformSettings.startingTranslateX+g),this.transformSettings.translateY=-1*(this.transformSettings.startingTranslateY+h)}this.setStartingScaleAndRotation(b,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var b=this.transformSettings.rotation%360,e=a.parseInt(this.transformSettings.translateX,10),f=a.parseInt(this.transformSettings.translateY,10),g="scale("+this.transformSettings.scale+") rotate("+b+"deg) translate("+e+"px, "+f+"px)";c.DOM.setStyle(this.transformEl,{webkitTransform:g,MozTransform:g,msTransform:g,transform:g}),c.Events.fire(this,{target:this,type:d.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:b,translateX:e,translateY:f})}})}(window,window.klass,window.Code.Util),function(a,b){b.registerNamespace("Code.PhotoSwipe");var c=a.Code.PhotoSwipe;c.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},c.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},c.instances=[],c.activeInstances=[],c.setActivateInstance=function(a){var d=b.arrayIndexOf(a.settings.target,c.activeInstances,"target");if(d>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";c.activeInstances.push({target:a.settings.target,instance:a})},c.unsetActivateInstance=function(a){var d=b.arrayIndexOf(a,c.activeInstances,"instance");c.activeInstances.splice(d,1)},c.attach=function(a,d,e){var f,g,h,i;for(h=c.createInstance(a,d,e),f=0,g=a.length;g>f;f++)i=a[f],b.isNothing(i.nodeType)||1===i.nodeType&&(i.__photoSwipeClickHandler=c.onTriggerElementClick.bind(h),b.Events.remove(i,"click",i.__photoSwipeClickHandler),b.Events.add(i,"click",i.__photoSwipeClickHandler));return h},a.jQuery&&(a.jQuery.fn.photoSwipe=function(a,b){return c.attach(this,a,b)}),c.detatch=function(a){var d,e,f;for(d=0,e=a.originalImages.length;e>d;d++)f=a.originalImages[d],b.isNothing(f.nodeType)||1===f.nodeType&&(b.Events.remove(f,"click",f.__photoSwipeClickHandler),delete f.__photoSwipeClickHandler);c.disposeInstance(a)},c.createInstance=function(a,d,e){var g;if(b.isNothing(a))throw"Code.PhotoSwipe.attach: No images passed.";if(!b.isLikeArray(a))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(1>a.length)throw"Code.PhotoSwipe.createInstance: No images to passed.";if(d=b.coalesce(d,{}),g=c.getInstance(e),!b.isNothing(g))throw'Code.PhotoSwipe.createInstance: Instance with id "'+e+' already exists."';return g=new c.PhotoSwipeClass(a,d,e),c.instances.push(g),g},c.disposeInstance=function(a){var b=c.getInstanceIndex(a);if(0>b)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";a.dispose(),c.instances.splice(b,1),a=null},c.onTriggerElementClick=function(a){a.preventDefault();var b=this;b.show(a.currentTarget)},c.getInstance=function(a){var b,d,e;for(b=0,d=c.instances.length;d>b;b++)if(e=c.instances[b],e.id===a)return e;return null},c.getInstanceIndex=function(a){var b,d,e=-1;for(b=0,d=c.instances.length;d>b;b++)if(c.instances[b]===a){e=b;break}return e}}(window,window.Code.Util),function(a,b,c,d,e,f,g,h,i){c.registerNamespace("Code.PhotoSwipe");var j=a.Code.PhotoSwipe;j.PhotoSwipeClass=b({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var a;c.Events.remove(this,j.EventTypes.onBeforeShow),c.Events.remove(this,j.EventTypes.onShow),c.Events.remove(this,j.EventTypes.onBeforeHide),c.Events.remove(this,j.EventTypes.onHide),c.Events.remove(this,j.EventTypes.onDisplayImage),c.Events.remove(this,j.EventTypes.onResetPosition),c.Events.remove(this,j.EventTypes.onSlideshowStart),c.Events.remove(this,j.EventTypes.onSlideshowStop),c.Events.remove(this,j.EventTypes.onTouch),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),c.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),c.isNothing(this.carousel)||this.carousel.dispose(),c.isNothing(this.uiLayer)||this.uiLayer.dispose(),c.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),c.isNothing(this.cache)||this.cache.dispose();
for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e,f){var g;this.id=c.isNothing(f)?"PhotoSwipe"+(""+(new Date).getTime()):f,this.originalImages=b,c.Browser.android&&!c.Browser.firefox&&(""+a.navigator.userAgent.match(/Android (\d+.\d+)/)).replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=c.objectHasProperty(a,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!c.isNothing(a.jQuery)&&!c.isNothing(a.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:a,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:j.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:j.Cache.Functions.getImageSource,getImageCaption:j.Cache.Functions.getImageCaption,getImageMetaData:j.Cache.Functions.getImageMetaData,cacheMode:j.Cache.Mode.normal},c.extend(this.settings,e),this.settings.target!==a&&(g=c.DOM.getStyle(this.settings.target,"position"),("relative"!==g||"absolute"!==g)&&c.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==a?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new d.CacheClass(b,this.settings)},show:function(b){var d,e;if(this._isResettingPosition=!1,this.backButtonClicked=!1,c.isNumber(b))this.currentIndex=b;else for(this.currentIndex=-1,d=0,e=this.originalImages.length;e>d;d++)if(this.originalImages[d]===b){this.currentIndex=d;break}if(0>this.currentIndex||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),j.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===a?c.DOM.addClass(a.document.body,j.CssClasses.buildingBody):c.DOM.addClass(this.settings.target,j.CssClasses.buildingBody),this.createComponents(),c.Events.fire(this,{type:j.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new e.DocumentOverlayClass(this.settings),this.carousel=new f.CarouselClass(this.cache,this.settings),this.uiLayer=new h.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new g.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var a=this.getWindowDimensions();(c.isNothing(this.windowDimensions)||a.width!==this.windowDimensions.width||a.height!==this.windowDimensions.height)&&(this._isResettingPosition=!0,this.windowDimensions=a,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),c.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,c.Events.fire(this,{type:j.EventTypes.onResetPosition,target:this}))}},addEventHandler:function(a,b){c.Events.add(this,a,b)},addEventHandlers:function(){if(c.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),c.Browser.android)this.orientationEventName="resize";else if(c.Browser.iOS&&!c.Browser.safari)c.Events.add(a.document.body,"orientationchange",this.windowOrientationChangeHandler);else{var b=!c.isNothing(a.onorientationchange);this.orientationEventName=b?"orientationchange":"resize"}c.isNothing(this.orientationEventName)||c.Events.add(a,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===a&&c.Events.add(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.add(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?a.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(""+(new Date).getTime()),a.location.hash=this.currentHistoryHashValue),c.Events.add(a,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&c.Events.add(a,"mousewheel",this.mouseWheelHandler),c.Events.add(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.Events.add(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),c.isNothing(this.toolbar)||(c.Events.add(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.add(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.add(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){c.Browser.iOS&&!c.Browser.safari&&c.Events.remove(a.document.body,"orientationchange",this.windowOrientationChangeHandler),c.isNothing(this.orientationEventName)||c.Events.remove(a,this.orientationEventName,this.windowOrientationChangeHandler),c.Events.remove(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.remove(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&c.Events.remove(a,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&c.Events.remove(a,"mousewheel",this.mouseWheelHandler),c.isNothing(this.uiLayer)||c.Events.remove(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.isNothing(this.toolbar)||(c.Events.remove(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),c.isNothing(this.toolbar)||(c.Events.remove(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.remove(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(c.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";c.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),c.Events.fire(this,{type:j.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,c.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,c.DOM.removeClass(a.document.body,j.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,j.unsetActivateInstance(this),c.Events.fire(this,{type:j.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||a.history.back())},play:function(){this.isZoomActive()||this.settings.preventSlideshow||c.isNothing(this.carousel)||(!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||c.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new i.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,c.Events.add(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),c.Events.fire(this,j.EventTypes.onZoomPanRotateShow),!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){c.isNothing(this.zoomPanRotate)||(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateHide),c.Events.remove(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,c.Events.fire(this,j.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var a,b;if(c.Browser.msie){if(a=document.createElement("div"),c.isNothing(a.style.msTransform))return!1}else if(!c.Browser.isCSSTransformSupported)return!1;return this.settings.allowUserZoom?this.carousel.isSliding?!1:(b=this.cache.images[this.currentIndex],c.isNothing(b)?!1:b.isLoading?!1:!0):!1},isZoomActive:function(){return!c.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){a.setTimeout(function(){var b=this.settings.target===a?a.document.body:this.settings.target;c.DOM.removeClass(b,j.CssClasses.buildingBody),c.DOM.addClass(b,j.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():c.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),c.Events.fire(this,{type:j.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&c.Browser.iOS&&!c.Browser.safari&&(c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=a.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){var c="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);a.location.hash!==c&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(a){37===a.keyCode?(a.preventDefault(),this.previous()):39===a.keyCode?(a.preventDefault(),this.next()):38===a.keyCode||40===a.keyCode?a.preventDefault():27===a.keyCode?(a.preventDefault(),this.hide()):32===a.keyCode?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),a.preventDefault()):13===a.keyCode&&(a.preventDefault(),this.play())},onUILayerTouch:function(b){if(this.isZoomActive())switch(b.action){case c.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(b.point);break;case c.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(b.point);break;case c.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(b.action){case c.TouchElement.ActionTypes.touchMove:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.touchStart:case c.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case c.TouchElement.ActionTypes.doubleTap:this.settings.target===a&&(b.point.x-=c.DOM.windowScrollLeft(),b.point.y-=c.DOM.windowScrollTop());var d=this.cache.images[this.currentIndex].imageEl,e=a.parseInt(c.DOM.getStyle(d,"top"),10),f=a.parseInt(c.DOM.getStyle(d,"left"),10),g=f+c.DOM.width(d),h=e+c.DOM.height(d);f>b.point.x?b.point.x=f:b.point.x>g&&(b.point.x=g),e>b.point.y?b.point.y=e:b.point.y>h&&(b.point.y=h),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,b.point);break;case c.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}c.Events.fire(this,{type:j.EventTypes.onTouch,target:this,point:b.point,action:b.action})},onCarouselSlideByEnd:function(a){this.currentIndex=a.cacheIndex,c.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),c.Events.fire(this,{type:j.EventTypes.onDisplayImage,target:this,action:a.action,index:a.cacheIndex})},onToolbarTap:function(a){switch(a.action){case g.ToolbarAction.next:this.next();break;case g.ToolbarAction.previous:this.previous();break;case g.ToolbarAction.close:this.hide();break;case g.ToolbarAction.play:this.play()}c.Events.fire(this,{type:j.EventTypes.onToolbarTap,target:this,toolbarAction:a.action,tapTarget:a.tapTarget})},onMouseWheel:function(a){var b=c.Events.getWheelDelta(a),d=a.timeStamp-(this.mouseWheelStartTime||0);this.settings.mouseWheelSpeed>d||(this.mouseWheelStartTime=a.timeStamp,this.settings.invertMouseWheel&&(b=-1*b),0>b?this.next():b>0&&this.previous())},onCarouselSlideshowStart:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(a){c.Events.fire(this,{target:this,type:j.EventTypes.onZoomPanRotateTransform,scale:a.scale,rotation:a.rotation,rotationDegs:a.rotationDegs,translateX:a.translateX,translateY:a.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate);